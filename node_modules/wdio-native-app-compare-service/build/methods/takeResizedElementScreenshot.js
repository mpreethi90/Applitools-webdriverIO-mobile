"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.takeResizedElementScreenshot = takeResizedElementScreenshot;

var _constants = require("../helpers/constants");

var _takeBase64Screenshot = require("../methods/takeBase64Screenshot");

var _getDeviceInfo = require("./getDeviceInfo");

var _makeCroppedBase64Image = require("./makeCroppedBase64Image");

var _rectangles = require("./rectangles");

var _utils = require("../helpers/utils");

/**
 * Save a resized element screenshot
 *
 * @param {object}  element
 * @param {string}  filePath
 * @param {object}  resizeDimensions
 *
 * @return {Promise<string>}
 *
 * @private
 */
async function takeResizedElementScreenshot(element, filePath, resizeDimensions = _constants.DEFAULT_RESIZE_DIMENSIONS) {
  // Determine location and size of element
  const elementRectangles = await (0, _rectangles.getElementRectangles)(element); // Take a screenshot

  const base64Screenshot = await (0, _takeBase64Screenshot.takeBase64Screenshot)(); // Get the device info like screenSize, screenshotHeight, screenshotHeight

  const {
    dpr
  } = await (0, _getDeviceInfo.getDeviceInfo)(base64Screenshot); // Create the cropped screenshot and return it

  return await (0, _makeCroppedBase64Image.makeCroppedBase64Image)(base64Screenshot, (0, _utils.multiplyIosObjectValuesAgainstDPR)({
    height: elementRectangles.height,
    width: elementRectangles.width,
    x: elementRectangles.x,
    y: elementRectangles.y
  }, dpr), resizeDimensions);
}